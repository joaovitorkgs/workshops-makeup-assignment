---
title: "IDS Workshops: Make-up Assignment"
author: "Joao Vitor Krieger | joaovitorkgs"
date: "`r format(Sys.time(), '%B %d, %Y | %H:%M:%S | %Z')`"
output:
  html_document:
    code_folding: show
    df_print: paged
    highlight: tango
    number_sections: no
    theme: cosmo
    toc: no
---

```{=html}
<style>
div.answer {background-color:#f3f0ff; border-radius: 5px; padding: 20px;}
div.comment {background-color:#F0F6FF; border-radius: 5px; padding: 20px;}

</style>
```
```{=html}
<style>
div.gradingadvice {background-color:#a2bc89; border-radius: 5px; padding: 20px;}
</style>
```
```{=html}
<style>
div.examplefeedback {background-color:#FFA500; border-radius: 5px; padding: 20px;}
</style>
```
```{=html}
<style>
div.lookfor {background-color:#a389bc; border-radius: 5px; padding: 20px;}
</style>
```
```{r, include=FALSE}
knitr::opts_chunk$set(echo = TRUE,
                      eval = TRUE,
                      error = FALSE,
                      message = FALSE,
                      warning = FALSE,
                      comment = NA)
```

<!-- Do not forget to input your Github username in the YAML configuration up there -->

------------------------------------------------------------------------

```{r, include = T}
pacman::p_load(readr,
               dplyr,
               tidyverse,
               countrycode,
               terra,
               geodata,
               purrr,
               scales, 
               ggplot2)
```

<br>

## Instructions

- Choose one of the datasets that youâ€™ve worked with in the Lab or any of the other assignments (e.g., the astronauts dataset from Assignment 1).

- Then, choose one or several of the packages presented at the workshop and use its functionality/tool to do something with the chosen dataset.

- The output should involve at least two of the following: (a) a plot, (b) a table, and (c) modeling in some form. The format should be knitted Rmd to HTML and submitted to me via email by November 15, 6pm.

------------------------------------------------------------------------

## Chosen Dataset and Packages Presented in the Workshop

I will be using the data from the [Stavnichuk and  Corlett](https://data.mendeley.com/datasets/86tsnnbv2w/1) article, with the specific data set prepared by [Georgios Karamanis](https://twitter.com/geokaramanis) which contains publically available information about all astronauts who participated in space missions before 15 January 2020 collected from NASA, Roscosmos, and fun-made websites. The provided information includes full astronaut name, sex, date of birth, nationality, military status, a title and year of a selection program, and information about each mission completed by a particular astronaut such as a year, ascend and descend shuttle names, mission and extravehicular activity (EVAs) durations.

As for the packages, I will be using

-- INTERACTIVE PLOTS
-- MAPS? JANITOR?

------------------------------------------------------------------------


### 1. Interactive Plot


```{r}

# Importing dataset and creating subset according to year of birth
astronauts <- read_csv("astronauts.csv")

astronauts_subset <- astronauts %>%
  group_by(nationality) %>% 
  summarize(
    count_astronauts = n(),
    number_of_missions = sum(total_number_of_missions),
    average_mission_hours = round(mean(hours_mission),2)
    ) %>% 
  mutate(average_missions_per_astronaut = round(number_of_missions/count_astronauts)/2)

# Testing if my data is already clean (correct country names)
country_codes_df <- geodata::country_codes() %>% 
  select(ISO3, NAME) %>% 
  rename(code = 1) %>% 
  rename(nationality = 2)

country_codes <-geodata::country_codes()

# Selecting countries where the name is outdated or wrong
outdated_country_names <- left_join(astronauts_subset,country_codes_df) %>% 
  select(nationality,code) %>% 
  filter(is.na(code))

# Creating a vector of old names (to be replaced)
old_names <- c(
  "Czechoslovakia",
  "Hungry",
  "Korea",
  "Malysia",
  "Netherland",
  "Republic of South Africa",
  "U.K.",
  "U.K./U.S.",
  "U.S.",
  "U.S.S.R/Russia",
  "U.S.S.R/Ukraine",
  "UAE"
  )

# Creating a vector of new names (replacements)
new_names <- c(
  "Czech Republic",
  "Hungary",
  "South Korea",
  "Malaysia",
  "Netherlands",
  "South Africa",
  "United Kingdom",
  "United Kingdom",
  "United States",
  "Russia",
  "Ukraine",
  "United Arab Emirates"
  )



update_names_func <- function(df, old_names, new_names){
  df %>% 
    mutate(nationality = recode(nationality, !!!setNames(new_names, old_names)))
}

updated_astronauts_df <- map_df(list(astronauts_subset), update_names_func, old_names, new_names)


nationalities_with_code <- left_join(updated_astronauts_df,country_codes_df) 


```

